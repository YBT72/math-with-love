<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>מתמטיקה באהבה</title>
  <!--
    We use a single CSS file that imports all other style files.
    This approach reduces repetitive code and makes maintenance easier.
    Additional page-specific styles are loaded dynamically via JavaScript.
  -->
  <link rel="stylesheet" href="styles/main.css">
</head>
<body>
  <!--
    The header, search box, and sidebar menu will be loaded dynamically into these containers.
    You do not need to change these IDs. They are used by JavaScript below.
  -->
  <header id="header-placeholder"></header>
  <div id="header-search-placeholder"></div>
  <div id="side-menu"></div>
  <!--
    This is the main content area for each page.
    When you create a new page, you can insert your unique content into <main id="page-content">.
  -->
  <main id="page-content">
    <!-- Unique page content goes here -->
  </main>
  
  <!-- Footer будет загружен сюда -->
  <footer id="footer-placeholder"></footer>
  
  <!-- Отладочная информация -->
  <div id="debug-info" style="position: fixed; bottom: 5px; left: 5px; background: rgba(0,0,0,0.7); color: white; padding: 5px; border-radius: 4px; font-size: 12px; z-index: 9999; display: none;">
    <div>Debug Info</div>
  </div>
</body>
<script>
  /*
    This script loads the shared header, footer and search box templates into the page.
    After loading, it loads the external JavaScript files for search and sidebar menu functionality.
    This way, every page that uses this layout will automatically have all features.
  */
  // Загружаем шапку сайта
  fetch('components/header.html')
    .then(response => response.text())
    .then(html => {
      document.getElementById('header-placeholder').innerHTML = html;
      
      // После загрузки шапки загружаем футер
      return fetch('components/footer.html');
    })
    .then(response => response.text())
    .then(html => {
      document.getElementById('footer-placeholder').innerHTML = html;
      
      // После загрузки всех компонентов загружаем скрипты
      loadExternalScripts();
    });

  // Loads external JS files for search and sidebar menu
  function loadExternalScripts() {
    console.log('🔄 Starting to load external scripts...');
    
    // Загружаем утилиту для управления стилями
    console.log('📄 Loading styles-loader.js...');
    const stylesLoaderScript = document.createElement('script');
    stylesLoaderScript.src = 'scripts/styles-loader.js';
    stylesLoaderScript.onload = () => console.log('✅ styles-loader.js loaded');
    stylesLoaderScript.onerror = () => console.error('❌ styles-loader.js failed to load');
    document.body.appendChild(stylesLoaderScript);
    
    // Loads search box functionality
    console.log('📄 Loading search.js...');
    const searchScript = document.createElement('script');
    searchScript.src = 'scripts/search.js';
    searchScript.onload = function() {
      console.log('✅ search.js loaded');
      if (typeof initSearchScripts === 'function') {
        initSearchScripts();
      }
    };
    searchScript.onerror = () => console.error('❌ search.js failed to load');
    document.body.appendChild(searchScript);

    // Loads sidebar menu functionality
    console.log('📄 Loading side-menu.js...');
    const sideMenuScript = document.createElement('script');
    sideMenuScript.src = 'scripts/side-menu.js';
    sideMenuScript.onload = function() {
      console.log('✅ side-menu.js loaded');
      if (typeof initSideMenuScripts === 'function') {
        initSideMenuScripts();
      }
    };
    sideMenuScript.onerror = () => console.error('❌ side-menu.js failed to load');
    document.body.appendChild(sideMenuScript);
    
    // Сразу загружаем диагностический скрипт
    console.log('📄 Loading debug.js...');
    const debugScript = document.createElement('script');
    debugScript.src = 'scripts/debug.js';
    debugScript.onload = () => console.log('✅ debug.js loaded');
    debugScript.onerror = () => console.error('❌ debug.js failed to load');
    document.body.appendChild(debugScript);
    
    // Загружаем sticky header скрипт
    console.log('📄 Loading sticky-header.js...');
    const stickyHeaderScript = document.createElement('script');
    stickyHeaderScript.src = 'scripts/sticky-header.js';
    stickyHeaderScript.onload = () => console.log('✅ sticky-header.js loaded');
    stickyHeaderScript.onerror = () => console.error('❌ sticky-header.js failed to load');
    document.body.appendChild(stickyHeaderScript);
    
    // Загружаем основной скрипт без задержки
    console.log('📄 Loading page-loader.js...');
    const pageLoaderScript = document.createElement('script');
    pageLoaderScript.src = 'scripts/page-loader.js';
    pageLoaderScript.onload = () => {
      console.log('✅ page-loader.js loaded');
      console.log('🔍 Checking if pageLoader exists:', typeof window.pageLoader);
    };
    pageLoaderScript.onerror = () => console.error('❌ page-loader.js failed to load');
    document.body.appendChild(pageLoaderScript);
  }
</script>
</html>
