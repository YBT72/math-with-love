<!-- 
===========================================
ğŸ® ××¡×¤×¨×™× ××¨×•×›×‘×™× - ×’×¨×¡×” ××•×“×¨× ×™×ª ××©×•×œ×‘×ª
×’×¨×¡×” ×”××©×•×œ×‘×ª ×¢× ×”×ª×¤×¨×™×˜ ×”×¨××©×™
===========================================
-->

<div class="modern-lesson-wrapper">
  
  <!-- ×¤×¡ ×”×ª×§×“××•×ª ××•×ª×× -->
  <div class="lesson-progress-modern">
    <div class="progress-container-modern">
      <div class="progress-fill-modern" id="main-progress" style="width: 0%"></div>
    </div>
    <div class="progress-info-modern">
      <span id="progress-text">0% ×”×•×©×œ×</span>
      <span class="lesson-points-modern" id="points-display">+0 × ×§×•×“×•×ª</span>
    </div>
  </div>

  <!-- × ×™×•×•×˜ ××©×•×œ×‘ -->
  <nav class="breadcrumb-integrated">
    <a href="#" onclick="window.pageLoader?.loadPage('home')" class="breadcrumb-link">×‘×™×ª</a>
    <span class="breadcrumb-separator">â†</span>
    <a href="#" onclick="window.pageLoader?.loadPage('courses/5-units/5-units-index')" class="breadcrumb-link">5 ×™×—×´×œ</a>
    <span class="breadcrumb-separator">â†</span>
    <a href="#" onclick="window.pageLoader?.loadPage('courses/5-units/35572/35572-index')" class="breadcrumb-link">×©××œ×•×Ÿ 35572</a>
    <span class="breadcrumb-separator">â†</span>
    <span class="breadcrumb-current">××¡×¤×¨×™× ××¨×•×›×‘×™× - ×¦×•×¨×” ××œ×’×‘×¨×™×ª</span>
  </nav>

  <!-- ×›×•×ª×¨×ª ××•×ª×××ª -->
  <div class="lesson-header-integrated">
    <div class="lesson-meta-integrated">
      <span class="meta-badge-integrated beginner">×‘×¡×™×¡×™</span>
      <span class="meta-badge-integrated">â±ï¸ 25 ×“×§×•×ª</span>
      <span class="meta-badge-integrated">ğŸ¯ 6 ××™×§×¨×•-×©×™×¢×•×¨×™×</span>
    </div>
    <h1 class="lesson-title-integrated">×¦×•×¨×” ××œ×’×‘×¨×™×ª ×©×œ ××¡×¤×¨×™× ××¨×•×›×‘×™×</h1>
    <p class="lesson-subtitle-integrated">×œ××™×“×” ××”×™×¨×” ×•××“×•×™×§×ª ×¢× ××™× ×˜×¨××§×˜×™×‘×™×•×ª ××œ××”</p>
  </div>

  <!-- ××™×§×¨×•-×©×™×¢×•×¨×™× -->
  <div class="micro-lessons-integrated">
    
    <!-- ××™×§×¨×•-×©×™×¢×•×¨ 1: ×”×›×¨×•×ª -->
    <div class="micro-lesson-integrated active" data-micro="1">
      <div class="micro-header-integrated">
        <div class="micro-number-integrated">1/6</div>
        <div class="micro-title-integrated">ğŸ¯ ×”×›×¨×•×ª ×¢× ××¡×¤×¨×™× ××¨×•×›×‘×™×</div>
        <div class="micro-timer-integrated" id="timer-1">3:00</div>
      </div>
      
      <div class="concept-intro-integrated">
        <h3>××” ×–×” ××¡×¤×¨ ××¨×•×›×‘?</h3>
        <p>×‘×•××• × ×ª×—×™×œ ×¢× ×”××©×•×•××” ×”×¤×©×•×˜×”:</p>
        <div class="math-display-integrated" id="intro-equation">xÂ² = -1</div>
        <p>×‘××ª××˜×™×§×” ×¨×’×™×œ×” ××™×Ÿ ×¤×ª×¨×•×Ÿ ×œ××©×•×•××” ×”×–×•. ××‘×œ ××” ×× × ×’×“×™×¨ ××¡×¤×¨ ×—×“×©?</p>
      </div>
      
      <div class="interactive-section-integrated">
        <div class="quick-question-integrated">
          <h4>×œ×“×¢×ª×›×, ×”×× ×œ××©×•×•××” ×”×–×• ×¦×¨×™×š ×œ×”×™×•×ª ×¤×ª×¨×•×Ÿ?</h4>
        </div>
        <div class="answer-options-integrated">
          <button class="answer-button-integrated" onclick="selectAnswer(this, false)">×œ×, ×–×” ×‘×œ×ª×™ ××¤×©×¨×™</button>
          <button class="answer-button-integrated" onclick="selectAnswer(this, true)">×›×Ÿ, ×‘×¢×–×¨×ª ××¡×¤×¨×™× ××¨×•×›×‘×™×</button>
          <button class="answer-button-integrated" onclick="selectAnswer(this, false)">×œ× ×‘×˜×•×—</button>
        </div>
        <div class="feedback-integrated" id="feedback-1"></div>
      </div>
      
      <div class="micro-navigation-integrated">
        <button class="nav-button-integrated secondary" disabled>â†’ ×§×•×“×</button>
        <button class="nav-button-integrated" onclick="if(window.nextMicro) window.nextMicro(); else alert('Function not loaded');">×”×‘× â†</button>
        <button class="nav-button-integrated" onclick="if(window.testButton) window.testButton(); else alert('Test: Functions work!');" style="background: #dc2626;">ğŸ”´ Test</button>
      </div>
    </div>

    <!-- ××™×§×¨×•-×©×™×¢×•×¨ 2: ×”×’×“×¨×” -->
    <div class="micro-lesson-integrated" data-micro="2">
      <div class="micro-header-integrated">
        <div class="micro-number-integrated">2/6</div>
        <div class="micro-title-integrated">ğŸ“ ×”×™×—×™×“×” ×”××“×•××” i</div>
        <div class="micro-timer-integrated" id="timer-2">4:00</div>
      </div>
      
      <div class="concept-intro-integrated">
        <h3>×‘×•××• × ×›×™×¨ ××ª i</h3>
        <p>× ×’×“×™×¨ ××¡×¤×¨ ××™×•×—×“ ×©× ×§×¨× "×”×™×—×™×“×” ×”××“×•××”":</p>
        <div class="math-concept-integrated">
          <div class="math-display-integrated" id="imaginary-unit"></div>
          <div class="math-explanation-integrated">×–×”×• ×”××¡×¤×¨ ×©×¤×•×ª×¨ ××ª ×”××©×•×•××” ×©×œ× ×•!</div>
        </div>
        
        <p>×¢×›×©×™×• × ×•×›×œ ×œ×›×ª×•×‘ ×›×œ ××¡×¤×¨ ××¨×•×›×‘ ×›×š:</p>
        <div class="math-concept-integrated">
          <div class="math-display-integrated" id="complex-form"></div>
          <div class="math-explanation-integrated">
            a = ×—×œ×§ ×××©×™, b = ×—×œ×§ ××“×•××”, i = ×™×—×™×“×” ××“×•××”
          </div>
        </div>
      </div>
      
      <div class="interactive-section-integrated">
        <div class="quick-question-integrated">
          <h4>×‘××¡×¤×¨ ×”××¨×•×›×‘ <span id="example-complex"></span>, ××” ×”×—×œ×§ ×”×××©×™?</h4>
        </div>
        <div class="answer-options-integrated">
          <button class="answer-button-integrated" onclick="selectAnswer(this, false)">2</button>
          <button class="answer-button-integrated" onclick="selectAnswer(this, true)">3</button>
          <button class="answer-button-integrated" onclick="selectAnswer(this, false)">5</button>
        </div>
        <div class="feedback-integrated" id="feedback-2"></div>
      </div>
      
      <div class="micro-navigation-integrated">
        <button class="nav-button-integrated secondary" onclick="prevMicro()">â†’ ×§×•×“×</button>
        <button class="nav-button-integrated" onclick="nextMicro()">×”×‘× â†</button>
      </div>
    </div>

    <!-- ××™×§×¨×•-×©×™×¢×•×¨ 3: ×¤×¢×•×œ×•×ª -->
    <div class="micro-lesson-integrated" data-micro="3">
      <div class="micro-header-integrated">
        <div class="micro-number-integrated">3/6</div>
        <div class="micro-title-integrated">â• ×¤×¢×•×œ×•×ª ×¢×œ ××¡×¤×¨×™× ××¨×•×›×‘×™×</div>
        <div class="micro-timer-integrated" id="timer-3">4:00</div>
      </div>
      
      <div class="concept-intro-integrated">
        <h3>××™×š ××—×‘×¨×™× ××¡×¤×¨×™× ××¨×•×›×‘×™×?</h3>
        <p>×–×” ×”×¨×‘×” ×™×•×ª×¨ ×¤×©×•×˜ ×××” ×©×–×” × ×¨××”!</p>
        
        <div class="math-concept-integrated">
          <div class="math-display-integrated" id="addition-rule"></div>
          <div class="math-explanation-integrated">××—×‘×¨×™× ×—×œ×§ ×××©×™ ×¢× ×—×œ×§ ×××©×™, ××“×•××” ×¢× ××“×•××”</div>
        </div>
        
        <div class="example-box-integrated">
          <h4>×“×•×’××”:</h4>
          <div class="math-display-integrated" id="addition-example-detailed"></div>
        </div>
      </div>
      
      <div class="interactive-section-integrated">
        <div class="quick-question-integrated">
          <h4>×—×©×‘×•: <span id="addition-exercise"></span></h4>
        </div>
        <div class="answer-options-integrated">
          <button class="answer-button-integrated" onclick="selectAnswer(this, false)">5 + 5i</button>
          <button class="answer-button-integrated" onclick="selectAnswer(this, true)">6 + 2i</button>
          <button class="answer-button-integrated" onclick="selectAnswer(this, false)">2 + 6i</button>
        </div>
        <div class="feedback-integrated" id="feedback-3"></div>
      </div>
      
      <div class="micro-navigation-integrated">
        <button class="nav-button-integrated secondary" onclick="prevMicro()">â†’ ×§×•×“×</button>
        <button class="nav-button-integrated" onclick="nextMicro()">×”×‘× â†</button>
      </div>
    </div>

    <!-- ××™×§×¨×•-×©×™×¢×•×¨ 4: ×¡×™×›×•× -->
    <div class="micro-lesson-integrated" data-micro="4">
      <div class="micro-header-integrated">
        <div class="micro-number-integrated">4/6</div>
        <div class="micro-title-integrated">ğŸ“Š ×™×™×¦×•×’ ×’×¨×¤×™</div>
        <div class="micro-timer-integrated" id="timer-4">4:00</div>
      </div>
      
      <div class="concept-intro-integrated">
        <h3>×›×œ ×”×›×‘×•×“! ×¡×™×™××ª× ×‘×”×¦×œ×—×”!</h3>
        <p>×¢×›×©×™×• ××ª× ×™×•×“×¢×™×:</p>
        <ul class="achievement-list-integrated">
          <li>âœ“ ××” ×–×” ××¡×¤×¨ ××¨×•×›×‘</li>
          <li>âœ“ ×”×¦×•×¨×” <span id="summary-form"></span></li>
          <li>âœ“ ××™×š ××—×‘×¨×™× ××¡×¤×¨×™× ××¨×•×›×‘×™×</li>
          <li>âœ“ ×”×™×—×™×“×” ×”××“×•××” <span id="summary-i"></span></li>
        </ul>
      </div>
      
      <div class="completion-badge-integrated">
        <h4>ğŸ† ×”×©×’×ª× 60 × ×§×•×“×•×ª!</h4>
        <p>×“×¨×’×” ×—×“×©×”: ××•××—×” ×¦×•×¨×” ××œ×’×‘×¨×™×ª</p>
        <div class="next-steps-integrated">
          <h5>××” ×”×œ××”?</h5>
          <ul>
            <li>×©×™×¢×•×¨ ×”×‘×: ×›×¤×œ ××¡×¤×¨×™× ××¨×•×›×‘×™×</li>
            <li>×ª×¨×’×•×œ × ×•×¡×£: ×ª×¨×’×™×œ×™× ××™× ×˜×¨××§×˜×™×‘×™×™×</li>
            <li>××‘×—×Ÿ: ×‘×“×™×§×ª ×”×‘× ×”</li>
          </ul>
        </div>
      </div>
      
      <div class="micro-navigation-integrated">
        <button class="nav-button-integrated secondary" onclick="prevMicro()">â†’ ×§×•×“×</button>
        <button class="nav-button-integrated" onclick="nextMicro()">×”×‘× â†</button>
      </div>
    </div>

    <!-- ××™×§×¨×•-×©×™×¢×•×¨ 5: ×›×¤×œ ××¡×¤×¨×™× ××¨×•×›×‘×™× -->
    <div class="micro-lesson-integrated" data-micro="5">
      <div class="micro-header-integrated">
        <div class="micro-number-integrated">5/6</div>
        <div class="micro-title-integrated">âœ–ï¸ ×›×¤×œ ××¡×¤×¨×™× ××¨×•×›×‘×™×</div>
        <div class="micro-timer-integrated" id="timer-5">5:00</div>
      </div>
      
      <div class="concept-intro-integrated">
        <h3>××™×š ××›×¤×™×œ×™× ××¡×¤×¨×™× ××¨×•×›×‘×™×?</h3>
        <p>×›×¤×œ ××¡×¤×¨×™× ××¨×•×›×‘×™× ×“×•××” ×œ×›×¤×œ ×‘×™×˜×•×™×™× ××œ×’×‘×¨×™×™×, ××‘×œ ×¢× ×—×•×§ ××™×•×—×“!</p>
        
        <div class="math-concept-integrated">
          <div class="math-display-integrated" id="multiplication-rule"></div>
          <div class="math-explanation-integrated">×–×›×¨×•: <span id="i-squared-rule"></span></div>
        </div>
        
        <div class="example-box-integrated">
          <h4>×“×•×’××” ××¤×•×¨×˜×ª:</h4>
          <div class="math-display-integrated" id="multiplication-example-step1"></div>
          <div class="math-display-integrated" id="multiplication-example-step2"></div>
          <div class="math-display-integrated" id="multiplication-example-step3"></div>
        </div>
      </div>
      
      <div class="interactive-section-integrated">
        <div class="quick-question-integrated">
          <h4>×—×©×‘×•: <span id="multiplication-exercise"></span></h4>
        </div>
        <div class="answer-options-integrated">
          <button class="answer-button-integrated" onclick="selectAnswer(this, false)">5 + 11i</button>
          <button class="answer-button-integrated" onclick="selectAnswer(this, true)">5 + 10i</button>
          <button class="answer-button-integrated" onclick="selectAnswer(this, false)">3 + 10i</button>
        </div>
        <div class="feedback-integrated" id="feedback-5"></div>
      </div>
      
      <div class="micro-navigation-integrated">
        <button class="nav-button-integrated secondary" onclick="prevMicro()">â†’ ×§×•×“×</button>
        <button class="nav-button-integrated" onclick="nextMicro()">×”×‘× â†</button>
      </div>
    </div>

    <!-- ××™×§×¨×•-×©×™×¢×•×¨ 6: ×ª×¨×’×™×œ×™× ××ª×§×“××™× -->
    <div class="micro-lesson-integrated" data-micro="6">
      <div class="micro-header-integrated">
        <div class="micro-number-integrated">6/6</div>
        <div class="micro-title-integrated">ğŸ¯ ×ª×¨×’×™×œ×™× ××ª×§×“××™× ×•×¡×™×›×•×</div>
        <div class="micro-timer-integrated" id="timer-6">5:00</div>
      </div>
      
      <div class="concept-intro-integrated">
        <h3>×‘×•××• × ×ª×¨×’×œ ×™×—×“!</h3>
        <p>×¢×›×©×™×• ×ª×¤×ª×¨×• ×ª×¨×’×™×œ×™× ××ª×§×“××™× ×™×•×ª×¨ ×›××• ×‘××‘×—×Ÿ ×××™×ª×™.</p>
        
        <div class="example-box-integrated">
          <h4>×ª×¨×’×™×œ 1: ××¦××• ××ª ×”×—×œ×§ ×”×××©×™ ×•×”××“×•××”</h4>
          <div class="math-display-integrated" id="advanced-exercise1"></div>
        </div>
      </div>
      
      <div class="interactive-section-integrated">
        <div class="quick-question-integrated">
          <h4>××” ×”×—×œ×§ ×”×××©×™ ×©×œ ×”×ª×©×•×‘×”?</h4>
        </div>
        <div class="answer-options-integrated">
          <button class="answer-button-integrated" onclick="selectAnswer6a(this, false)">2</button>
          <button class="answer-button-integrated" onclick="selectAnswer6a(this, true)">4</button>
          <button class="answer-button-integrated" onclick="selectAnswer6a(this, false)">-3</button>
        </div>
        <div class="feedback-integrated" id="feedback-6a"></div>
      </div>

      <div class="concept-intro-integrated" style="margin-top: 30px;">
        <div class="example-box-integrated">
          <h4>×ª×¨×’×™×œ 2: ×¤×ª×¨×• ××ª ×”××©×•×•××”</h4>
          <div class="math-display-integrated" id="advanced-exercise2"></div>
        </div>
      </div>
      
      <div class="interactive-section-integrated">
        <div class="quick-question-integrated">
          <h4>××” ×”×¤×ª×¨×•×Ÿ z?</h4>
        </div>
        <div class="answer-options-integrated">
          <button class="answer-button-integrated" onclick="selectAnswer6b(this, true)">z = 1 + 2i</button>
          <button class="answer-button-integrated" onclick="selectAnswer6b(this, false)">z = 2 + i</button>
          <button class="answer-button-integrated" onclick="selectAnswer6b(this, false)">z = 3 + i</button>
        </div>
        <div class="feedback-integrated" id="feedback-6b"></div>
      </div>

      <!-- ×¡×™×›×•× ×”×™×©×’×™× -->
      <div class="completion-badge-integrated" style="margin-top: 30px;">
        <h4>ğŸ† ×”×©×’×ª× 100 × ×§×•×“×•×ª!</h4>
        <p>×“×¨×’×” ×—×“×©×”: ××•××—×” ××¡×¤×¨×™× ××¨×•×›×‘×™×</p>
        <div class="next-steps-integrated">
          <h5>×œ××“×ª×:</h5>
          <ul>
            <li>âœ“ ×”×¦×•×¨×” ×”×‘×¡×™×¡×™×ª a + bi</li>
            <li>âœ“ ×—×™×‘×•×¨ ××¡×¤×¨×™× ××¨×•×›×‘×™×</li>
            <li>âœ“ ×›×¤×œ ××¡×¤×¨×™× ××¨×•×›×‘×™×</li>
            <li>âœ“ ×¤×ª×¨×•×Ÿ ×ª×¨×’×™×œ×™× ××ª×§×“××™×</li>
          </ul>
          <h5>××” ×”×œ××”?</h5>
          <ul>
            <li>×¦×•×¨×” ×§×•×˜×‘×™×ª ×©×œ ××¡×¤×¨×™× ××¨×•×›×‘×™×</li>
            <li>××©×¤×˜ ×“×”-××•××‘×¨</li>
            <li>×©×•×¨×©×™× ×©×œ ××¡×¤×¨×™× ××¨×•×›×‘×™×</li>
          </ul>
        </div>
      </div>

      <!-- ×ª×¨×’×™×œ×™× ×œ×‘×™×ª -->
      <div class="homework-section-integrated" style="margin-top: 30px;">
        <h4>ğŸ“š ×ª×¨×’×™×œ×™× ×œ×‘×™×ª</h4>
        <p>×¤×ª×¨×• ××ª ×”×ª×¨×’×™×œ×™× ×”×‘××™× ×•×‘×“×§×• ××ª ×”×ª×©×•×‘×•×ª:</p>
        
        <div class="homework-exercise-integrated">
          <h5>×ª×¨×’×™×œ 1:</h5>
          <p>×—×©×‘×•: (3 + 2i) + (1 - 4i) = ?</p>
          <details class="homework-solution-integrated">
            <summary>×¤×ª×¨×•×Ÿ:</summary>
            <div class="math-display-integrated" style="font-size: 1.2rem;">
              (3 + 2i) + (1 - 4i) = (3 + 1) + (2i - 4i) = 4 - 2i
            </div>
          </details>
        </div>

        <div class="homework-exercise-integrated">
          <h5>×ª×¨×’×™×œ 2:</h5>
          <p>×—×©×‘×•: (2 + 3i) Ã— (1 - i) = ?</p>
          <details class="homework-solution-integrated">
            <summary>×¤×ª×¨×•×Ÿ:</summary>
            <div class="math-display-integrated" style="font-size: 1.2rem;">
              (2 + 3i)(1 - i) = 2 - 2i + 3i - 3iÂ² = 2 + i - 3(-1) = 2 + i + 3 = 5 + i
            </div>
          </details>
        </div>

        <div class="homework-exercise-integrated">
          <h5>×ª×¨×’×™×œ 3:</h5>
          <p>××¦××• ××ª ×”×—×œ×§ ×”×××©×™ ×•×”××“×•××” ×©×œ: (4 - 2i) Ã— (3 + i)</p>
          <details class="homework-solution-integrated">
            <summary>×¤×ª×¨×•×Ÿ:</summary>
            <div class="math-display-integrated" style="font-size: 1.2rem;">
              (4 - 2i)(3 + i) = 12 + 4i - 6i - 2iÂ² = 12 - 2i + 2 = 14 - 2i
            </div>
            <p><strong>×—×œ×§ ×××©×™:</strong> 14, <strong>×—×œ×§ ××“×•××”:</strong> -2</p>
          </details>
        </div>
      </div>
      
      <div class="micro-navigation-integrated">
        <button class="nav-button-integrated secondary" onclick="prevMicro()">â†’ ×§×•×“×</button>
        <button class="nav-button-integrated success" onclick="completeLessons()">×¡×™×•× ××¢×•×œ×”! âœ“</button>
      </div>
    </div>

  </div>

</div>

<style>
/* ===== ×¦×‘×¢×™× ××§×¦×•×¢×™×™× ===== */
:root {
  --primary-blue: #1e40af;
  --secondary-blue: #3b82f6;
  --light-blue: #dbeafe;
  --text-dark: #1f2937;
  --text-medium: #4b5563;
  --text-light: #6b7280;
  --background-light: #f8fafc;
  --white: #ffffff;
  --border-light: #e5e7eb;
  --success-green: #059669;
  --warning-orange: #d97706;
  --surface: #ffffff;
}

/* ===== Container ×¨××©×™ ===== */
.modern-lesson-wrapper {
  max-width: 900px;
  margin: 0 auto;
  padding: 20px;
  background: var(--background-light);
  min-height: 100vh;
  direction: rtl;
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
}

/* ===== ×¤×¡ ×”×ª×§×“××•×ª ××•×ª×× (×œ× ×§×‘×•×¢) ===== */
.lesson-progress-modern {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: 12px;
  padding: 16px;
  margin-bottom: 24px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.04);
}

.progress-container-modern {
  background: var(--border-light);
  height: 8px;
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 12px;
}

.progress-fill-modern {
  background: linear-gradient(90deg, var(--secondary-blue), var(--primary-blue));
  height: 100%;
  border-radius: 4px;
  transition: width 0.5s ease;
}

.progress-info-modern {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 0.875rem;
  color: var(--text-medium);
}

.lesson-points-modern {
  background: var(--success-green);
  color: var(--white);
  padding: 4px 12px;
  border-radius: 16px;
  font-weight: 600;
  font-size: 0.75rem;
}

/* ===== × ×™×•×•×˜ ××©×•×œ×‘ ===== */
.breadcrumb-integrated {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: 8px;
  padding: 12px 20px;
  margin-bottom: 24px;
  font-size: 0.875rem;
}

.breadcrumb-link {
  color: var(--primary-blue);
  text-decoration: none;
  font-weight: 500;
  transition: color 0.2s;
}

.breadcrumb-link:hover {
  color: var(--secondary-blue);
}

.breadcrumb-separator {
  margin: 0 8px;
  color: var(--text-medium);
}

.breadcrumb-current {
  color: var(--text-dark);
  font-weight: 600;
}

/* ===== ×›×•×ª×¨×ª ××©×•×œ×‘×ª ===== */
.lesson-header-integrated {
  background: linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-blue) 100%);
  color: var(--white);
  padding: 32px;
  border-radius: 12px;
  margin-bottom: 32px;
  text-align: center;
}

.lesson-meta-integrated {
  display: flex;
  justify-content: center;
  gap: 16px;
  margin-bottom: 20px;
  flex-wrap: wrap;
}

.meta-badge-integrated {
  background: rgba(255,255,255,0.2);
  padding: 6px 12px;
  border-radius: 16px;
  font-size: 0.75rem;
  font-weight: 500;
  backdrop-filter: blur(10px);
}

.lesson-title-integrated {
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 12px;
}

.lesson-subtitle-integrated {
  font-size: 1.125rem;
  opacity: 0.9;
  font-weight: 400;
}

/* ===== ××™×§×¨×•-×©×™×¢×•×¨×™× ××©×•×œ×‘×™× ===== */
.micro-lessons-integrated {
  display: flex;
  flex-direction: column;
  gap: 24px;
}

.micro-lesson-integrated {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: 12px;
  padding: 28px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  transform: translateY(10px);
  opacity: 0;
  transition: all 0.4s ease;
  display: none;
}

.micro-lesson-integrated.active {
  display: block;
  transform: translateY(0);
  opacity: 1;
}

.micro-header-integrated {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
  padding-bottom: 16px;
  border-bottom: 2px solid var(--light-blue);
}

.micro-number-integrated {
  background: var(--primary-blue);
  color: var(--white);
  padding: 8px 16px;
  border-radius: 20px;
  font-weight: 700;
  font-size: 0.875rem;
  min-width: 60px;
  text-align: center;
}

.micro-title-integrated {
  font-size: 1.375rem;
  font-weight: 600;
  color: var(--text-dark);
  flex-grow: 1;
  text-align: center;
  margin: 0 16px;
}

.micro-timer-integrated {
  background: var(--light-blue);
  color: var(--primary-blue);
  padding: 8px 16px;
  border-radius: 20px;
  font-weight: 700;
  font-size: 0.875rem;
  border: 2px solid var(--secondary-blue);
  min-width: 60px;
  text-align: center;
}

/* ===== ×ª×•×›×Ÿ ×©×™×¢×•×¨×™× ===== */
.concept-intro-integrated {
  margin-bottom: 28px;
}

.concept-intro-integrated h3 {
  color: var(--primary-blue);
  font-size: 1.5rem;
  margin-bottom: 16px;
  font-weight: 600;
}

.concept-intro-integrated p {
  color: var(--text-medium);
  font-size: 1.125rem;
  margin-bottom: 16px;
  line-height: 1.7;
}

.math-display-integrated {
  text-align: center !important;
  margin: 20px auto;
  font-size: 1.5rem;
  color: var(--primary-blue);
  font-weight: 600;
  direction: ltr;
  unicode-bidi: embed;
  display: block;
  width: 100%;
}

.math-concept-integrated {
  background: linear-gradient(135deg, var(--light-blue), #f0f9ff);
  border: 2px solid var(--secondary-blue);
  border-radius: 12px;
  padding: 24px;
  margin: 20px 0;
  text-align: center;
  direction: ltr;
  unicode-bidi: embed;
}

.math-explanation-integrated {
  color: var(--text-medium);
  font-size: 1rem;
  margin-top: 12px;
  font-style: italic;
}

.example-box-integrated {
  background: #fffbeb;
  border: 2px solid var(--warning-orange);
  border-radius: 8px;
  padding: 20px;
  margin: 16px 0;
}

.example-box-integrated h4 {
  color: var(--warning-orange);
  margin-bottom: 12px;
  font-weight: 600;
}

.example-box-integrated .math-display-integrated {
  direction: ltr;
  unicode-bidi: embed;
}

/* ===== ××™× ×˜×¨××§×˜×™×‘×™×•×ª ===== */
.interactive-section-integrated {
  background: var(--light-blue);
  border-radius: 12px;
  padding: 24px;
  margin: 24px 0;
  border: 2px solid var(--secondary-blue);
}

.quick-question-integrated {
  text-align: center;
  margin-bottom: 20px;
}

.quick-question-integrated h4 {
  color: var(--text-dark);
  font-size: 1.25rem;
  font-weight: 600;
  margin-bottom: 8px;
}

.answer-options-integrated {
  display: flex;
  gap: 12px;
  justify-content: center;
  flex-wrap: wrap;
  margin-bottom: 16px;
}

.answer-button-integrated {
  background: var(--surface);
  border: 2px solid var(--border-light);
  color: var(--text-dark);
  padding: 12px 20px;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s;
  font-weight: 500;
  font-size: 0.875rem;
  min-width: 120px;
  direction: ltr;
  unicode-bidi: embed;
}

.answer-button-integrated:hover {
  border-color: var(--secondary-blue);
  background: var(--surface);
  transform: translateY(-1px);
  box-shadow: 0 4px 8px rgba(59, 130, 246, 0.2);
}

.answer-button-integrated.correct {
  background: var(--success-green);
  color: var(--white);
  border-color: var(--success-green);
}

.answer-button-integrated.selected {
  background: var(--primary-blue);
  color: var(--white);
  border-color: var(--primary-blue);
}

.feedback-integrated {
  margin-top: 16px;
  padding: 12px;
  border-radius: 8px;
  font-weight: 500;
  text-align: center;
  display: none;
}

.feedback-integrated.success {
  background: #ecfdf5;
  color: var(--success-green);
  border: 2px solid #a7f3d0;
}

.feedback-integrated.error {
  background: #fef2f2;
  color: #dc2626;
  border: 2px solid #fecaca;
}

/* ===== × ×™×•×•×˜ ===== */
.micro-navigation-integrated {
  margin-top: 32px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 16px;
}

.nav-button-integrated {
  background: var(--primary-blue);
  color: var(--white);
  border: none;
  padding: 12px 24px;
  border-radius: 8px;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  min-width: 120px;
}

.nav-button-integrated:hover {
  background: var(--secondary-blue);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(30, 64, 175, 0.3);
}

.nav-button-integrated:disabled {
  background: var(--border-light);
  color: var(--text-light);
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}

.nav-button-integrated.secondary {
  background: transparent;
  color: var(--text-medium);
  border: 2px solid var(--border-light);
}

.nav-button-integrated.secondary:hover:not(:disabled) {
  background: var(--light-blue);
  color: var(--primary-blue);
  border-color: var(--secondary-blue);
}

.nav-button-integrated.success {
  background: var(--success-green);
}

.nav-button-integrated.success:hover {
  background: #047857;
}

/* ===== ×¡×™×›×•× ===== */
.achievement-list-integrated {
  text-align: right;
  margin: 20px 0;
  list-style: none;
  padding: 0;
}

.achievement-list-integrated li {
  padding: 8px 0;
  font-size: 1.125rem;
  color: var(--text-dark);
}

.completion-badge-integrated {
  background: #ecfdf5;
  border: 2px solid var(--success-green);
  border-radius: 12px;
  padding: 24px;
  text-align: center;
  margin: 24px 0;
}

.completion-badge-integrated h4 {
  color: var(--success-green);
  margin-bottom: 12px;
  font-size: 1.375rem;
}

.completion-badge-integrated p {
  color: var(--success-green);
  font-weight: 500;
  margin-bottom: 20px;
}

.next-steps-integrated {
  background: var(--surface);
  border-radius: 8px;
  padding: 16px;
  margin-top: 16px;
}

.next-steps-integrated h5 {
  color: var(--text-dark);
  margin-bottom: 12px;
  font-weight: 600;
}

.next-steps-integrated ul {
  text-align: right;
  list-style: none;
  padding: 0;
}

.next-steps-integrated li {
  padding: 4px 0;
  color: var(--text-medium);
}

/* ===== ×¨×¡×¤×•× ×¡×™×‘×™×•×ª ===== */
@media (max-width: 768px) {
  .modern-lesson-wrapper {
    padding: 16px;
  }
  
  .lesson-header-integrated {
    padding: 24px 20px;
  }
  
  .lesson-title-integrated {
    font-size: 1.5rem;
  }
  
  .micro-lesson-integrated {
    padding: 20px;
  }
  
  .micro-header-integrated {
    flex-direction: column;
    gap: 12px;
    text-align: center;
  }
  
  .micro-title-integrated {
    margin: 0;
    font-size: 1.25rem;
  }
  
  .answer-options-integrated {
    flex-direction: column;
    align-items: center;
  }
  
  .answer-button-integrated {
    width: 100%;
    max-width: 280px;
  }
  
  .micro-navigation-integrated {
    flex-direction: column;
    gap: 12px;
  }
  
  .nav-button-integrated {
    width: 100%;
  }
}

/* ===== ×ª×¨×’×™×œ×™× ×œ×‘×™×ª ===== */
.homework-section-integrated {
  background: #f0fdf4;
  border: 2px solid var(--success-green);
  border-radius: 12px;
  padding: 24px;
  margin: 24px 0;
}

.homework-section-integrated h4 {
  color: var(--success-green);
  margin-bottom: 16px;
  font-size: 1.375rem;
}

.homework-exercise-integrated {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: 8px;
  padding: 16px;
  margin: 16px 0;
}

.homework-exercise-integrated h5 {
  color: var(--text-dark);
  margin-bottom: 8px;
  font-weight: 600;
}

.homework-solution-integrated {
  margin-top: 12px;
  padding: 12px;
  background: var(--light-blue);
  border-radius: 6px;
}

.homework-solution-integrated summary {
  cursor: pointer;
  color: var(--primary-blue);
  font-weight: 600;
  padding: 4px 0;
}

.homework-solution-integrated summary:hover {
  color: var(--secondary-blue);
}

.homework-solution-integrated[open] summary {
  border-bottom: 1px solid var(--border-light);
  margin-bottom: 12px;
}

/* ===== ×›×œ×œ×™ ×œ××ª××˜×™×§×” - ×ª××™×“ LTR ===== */
.katex, .katex-display, .math-display-integrated, .math-concept-integrated .katex,
span[id*="equation"], span[id*="math"], span[id*="formula"],
#intro-equation, #imaginary-unit, #complex-form, #example-complex,
#addition-rule, #addition-example-detailed, #addition-exercise,
#summary-form, #summary-i,
h4 span[id*="addition"], h4 span[id*="equation"], h4 span[id*="exercise"],
.quick-question-integrated span[id*="addition"], .quick-question-integrated span[id*="exercise"] {
  direction: ltr !important;
  unicode-bidi: embed !important;
  text-align: center !important;
  display: block !important;
  margin: 0 auto !important;
  width: 100% !important;
}
</style>

<script>
// ===== Ğ¡ĞĞ—Ğ”ĞĞ•Ğœ Ğ“Ğ›ĞĞ‘ĞĞ›Ğ¬ĞĞ«Ğ™ ĞĞ‘ĞªĞ•ĞšĞ¢ Ğ”Ğ›Ğ¯ Ğ£Ğ ĞĞšĞ =====
window.ComplexNumbersLesson = {
  currentMicro: 1,
  totalPoints: 0,
  totalMicros: 6,
  
  updateProgress: function() {
    const progress = (this.currentMicro / this.totalMicros) * 100;
    const progressElement = document.getElementById('main-progress');
    const textElement = document.getElementById('progress-text');
    
    if (progressElement) progressElement.style.width = progress + '%';
    if (textElement) textElement.textContent = Math.round(progress) + '% ×”×•×©×œ×';
  },
  
  addPoints: function(points) {
    this.totalPoints += points;
    const pointsElement = document.getElementById('points-display');
    if (pointsElement) pointsElement.textContent = `+${this.totalPoints} × ×§×•×“×•×ª`;
  },
  
  nextMicro: function() {
    console.log('ğŸ”„ nextMicro called, currentMicro:', this.currentMicro, 'totalMicros:', this.totalMicros);
    if (this.currentMicro < this.totalMicros) {
      const currentElement = document.querySelector(`[data-micro="${this.currentMicro}"]`);
      const nextElement = document.querySelector(`[data-micro="${this.currentMicro + 1}"]`);
      
      if (currentElement && nextElement) {
        currentElement.classList.remove('active');
        this.currentMicro++;
        nextElement.classList.add('active');
        this.updateProgress();
        this.addPoints(15);
        
        console.log('âœ… Moved to micro:', this.currentMicro);
        
        // ×’×œ×™×œ×” ×—×œ×§×” ×œ××¢×œ×”
        nextElement.scrollIntoView({ 
          behavior: 'smooth', 
          block: 'start' 
        });
      } else {
        console.error('âŒ Elements not found:', { currentElement, nextElement });
      }
    } else {
      console.log('âš ï¸ Already at last micro');
    }
  },
  
  prevMicro: function() {
    console.log('ğŸ”„ prevMicro called, currentMicro:', this.currentMicro);
    if (this.currentMicro > 1) {
      const currentElement = document.querySelector(`[data-micro="${this.currentMicro}"]`);
      const prevElement = document.querySelector(`[data-micro="${this.currentMicro - 1}"]`);
      
      if (currentElement && prevElement) {
        currentElement.classList.remove('active');
        this.currentMicro--;
        prevElement.classList.add('active');
        this.updateProgress();
        
        console.log('âœ… Moved back to micro:', this.currentMicro);
        
        // ×’×œ×™×œ×” ×—×œ×§×” ×œ××¢×œ×”
        prevElement.scrollIntoView({ 
          behavior: 'smooth', 
          block: 'start' 
        });
      } else {
        console.error('âŒ Elements not found:', { currentElement, prevElement });
      }
    } else {
      console.log('âš ï¸ Already at first micro');
    }
  },
  
  selectAnswer: function(button, isCorrect) {
    const feedbackId = `feedback-${this.currentMicro}`;
    const feedback = document.getElementById(feedbackId);
    const allButtons = button.parentElement.querySelectorAll('.answer-button-integrated');
    
    // ××™×¤×•×¡ ×‘×—×™×¨×•×ª ×§×•×“××•×ª
    allButtons.forEach(btn => {
      btn.classList.remove('selected', 'correct');
    });
    
    // ×¡×™××•×Ÿ ×”×ª×©×•×‘×”
    button.classList.add('selected');
    
    if (isCorrect) {
      button.classList.add('correct');
      feedback.className = 'feedback-integrated success';
      feedback.textContent = 'âœ… × ×›×•×Ÿ ×××•×“! ××¢×•×œ×”!';
      feedback.style.display = 'block';
      this.addPoints(10);
    } else {
      feedback.className = 'feedback-integrated error';
      feedback.textContent = 'âŒ ×œ× × ×›×•×Ÿ. ×—×©×‘×• ×©×•×‘ ×•× ×¡×•!';
      feedback.style.display = 'block';
    }
  }
};

// Ğ Ğ•Ğ“Ğ˜Ğ¡Ğ¢Ğ Ğ˜Ğ Ğ£Ğ•Ğœ Ğ“Ğ›ĞĞ‘ĞĞ›Ğ¬ĞĞ«Ğ• Ğ¤Ğ£ĞĞšĞ¦Ğ˜Ğ˜
window.nextMicro = function() { window.ComplexNumbersLesson.nextMicro(); };
window.prevMicro = function() { window.ComplexNumbersLesson.prevMicro(); };
window.selectAnswer = function(button, isCorrect) { window.ComplexNumbersLesson.selectAnswer(button, isCorrect); };

window.testButton = function() {
  console.log('ğŸ”´ Test button clicked!');
  alert('âœ… ALL FUNCTIONS WORKING! CurrentMicro: ' + window.ComplexNumbersLesson.currentMicro);
};

console.log('ğŸŒ Complex Numbers Lesson object created:', window.ComplexNumbersLesson);
console.log('ğŸŒ Global functions registered:', {
  nextMicro: typeof window.nextMicro,
  prevMicro: typeof window.prevMicro,
  selectAnswer: typeof window.selectAnswer,
  testButton: typeof window.testButton
});

console.log('ğŸ“œ Modern lesson script loaded!');
console.log('ğŸ” KaTeX available:', typeof katex !== 'undefined');
console.log('ğŸ” Document ready state:', document.readyState);

// ===== Ğ“Ğ›ĞĞ‘ĞĞ›Ğ¬ĞĞ«Ğ• ĞŸĞ•Ğ Ğ•ĞœĞ•ĞĞĞ«Ğ• Ğ”Ğ›Ğ¯ ĞĞ‘Ğ ĞĞ¢ĞĞĞ™ Ğ¡ĞĞ’ĞœĞ•Ğ¡Ğ¢Ğ˜ĞœĞĞ¡Ğ¢Ğ˜ =====
let currentMicro = 1;
let totalPoints = 0;
const totalMicros = 6;

// ===== ĞĞ•ĞœĞ•Ğ”Ğ›Ğ•ĞĞĞĞ¯ Ğ Ğ•Ğ“Ğ˜Ğ¡Ğ¢Ğ ĞĞ¦Ğ˜Ğ¯ Ğ“Ğ›ĞĞ‘ĞĞ›Ğ¬ĞĞ«Ğ¥ Ğ¤Ğ£ĞĞšĞ¦Ğ˜Ğ™ =====
window.nextMicro = function() {
  console.log('ğŸ”„ nextMicro called, currentMicro:', currentMicro, 'totalMicros:', totalMicros);
  if (currentMicro < totalMicros) {
    const currentElement = document.querySelector(`[data-micro="${currentMicro}"]`);
    const nextElement = document.querySelector(`[data-micro="${currentMicro + 1}"]`);
    
    if (currentElement && nextElement) {
      currentElement.classList.remove('active');
      currentMicro++;
      nextElement.classList.add('active');
      updateProgress();
      addPoints(15);
      
      console.log('âœ… Moved to micro:', currentMicro);
      
      // ×’×œ×™×œ×” ×—×œ×§×” ×œ××¢×œ×”
      nextElement.scrollIntoView({ 
        behavior: 'smooth', 
        block: 'start' 
      });
    } else {
      console.error('âŒ Elements not found:', { currentElement, nextElement });
    }
  } else {
    console.log('âš ï¸ Already at last micro');
  }
};

window.prevMicro = function() {
  console.log('ğŸ”„ prevMicro called, currentMicro:', currentMicro);
  if (currentMicro > 1) {
    const currentElement = document.querySelector(`[data-micro="${currentMicro}"]`);
    const prevElement = document.querySelector(`[data-micro="${currentMicro - 1}"]`);
    
    if (currentElement && prevElement) {
      currentElement.classList.remove('active');
      currentMicro--;
      prevElement.classList.add('active');
      updateProgress();
      
      console.log('âœ… Moved back to micro:', currentMicro);
      
      // ×’×œ×™×œ×” ×—×œ×§×” ×œ××¢×œ×”
      prevElement.scrollIntoView({ 
        behavior: 'smooth', 
        block: 'start' 
      });
    } else {
      console.error('âŒ Elements not found:', { currentElement, prevElement });
    }
  } else {
    console.log('âš ï¸ Already at first micro');
  }
};

window.selectAnswer = function(button, isCorrect) {
  console.log('ğŸ”„ selectAnswer called for micro:', currentMicro, 'isCorrect:', isCorrect);
  const feedbackId = `feedback-${currentMicro}`;
  const feedback = document.getElementById(feedbackId);
  const allButtons = button.parentElement.querySelectorAll('.answer-button-integrated');
  
  // ××™×¤×•×¡ ×‘×—×™×¨×•×ª ×§×•×“××•×ª
  allButtons.forEach(btn => {
    btn.classList.remove('selected', 'correct');
  });
  
  // ×¡×™××•×Ÿ ×”×ª×©×•×‘×”
  button.classList.add('selected');
  
  if (isCorrect) {
    button.classList.add('correct');
    feedback.className = 'feedback-integrated success';
    feedback.textContent = 'âœ… × ×›×•×Ÿ ×××•×“! ××¢×•×œ×”!';
    feedback.style.display = 'block';
    addPoints(10);
  } else {
    feedback.className = 'feedback-integrated error';
    feedback.textContent = 'âŒ ×œ× × ×›×•×Ÿ. ×—×©×‘×• ×©×•×‘ ×•× ×¡×•!';
    feedback.style.display = 'block';
  }
};

window.testButton = function() {
  console.log('ğŸ”´ Test button clicked!');
  alert('âœ… JavaScript functions are working correctly!');
};

// ×¢×“×›×•×Ÿ ×”×ª×§×“××•×ª
function updateProgress() {
  const progress = (currentMicro / totalMicros) * 100;
  const progressBar = document.getElementById('main-progress');
  const progressText = document.getElementById('progress-text');
  
  if (progressBar) progressBar.style.width = progress + '%';
  if (progressText) progressText.textContent = Math.round(progress) + '% ×”×•×©×œ×';
}

// ×”×•×¡×¤×ª × ×§×•×“×•×ª
function addPoints(points) {
  totalPoints += points;
  const pointsDisplay = document.getElementById('points-display');
  if (pointsDisplay) pointsDisplay.textContent = `+${totalPoints} × ×§×•×“×•×ª`;
}

console.log('ğŸŒ Global functions registered immediately:', {
  nextMicro: typeof window.nextMicro,
  prevMicro: typeof window.prevMicro,
  selectAnswer: typeof window.selectAnswer,
  testButton: typeof window.testButton
});

// ×¨× ×“×•×¨ ××ª××˜×™×§×” ×¢× KaTeX
function renderMath() {
  try {
    // ×‘×“×™×§×” ×× KaTeX ×–××™×Ÿ
    if (typeof katex === 'undefined') {
      console.error('âŒ KaTeX is not loaded! Using fallback text rendering.');
      // Fallback - ×”×¦×’×ª × ×•×¡×—××•×ª ×‘×˜×§×¡×˜ ×¤×©×•×˜
      const elements = [
        { id: 'intro-equation', text: 'xÂ² = -1' },
        { id: 'imaginary-unit', text: 'iÂ² = -1' },
        { id: 'complex-form', text: 'z = a + bi' },
        { id: 'example-complex', text: 'z = 3 + 2i' }
      ];
      
      elements.forEach(elem => {
        const el = document.getElementById(elem.id);
        if (el) el.textContent = elem.text;
      });
      return;
    }
    
    console.log('ğŸ”„ Starting math rendering...');
    
    // ×‘×“×™×§×” ×× ×”××œ×× ×˜×™× ×§×™×™××™×
    const introEq = document.getElementById("intro-equation");
    if (introEq) {
      katex.render("x^2 = -1", introEq);
      console.log('âœ… Rendered intro-equation');
    } else {
      console.error('âŒ Element intro-equation not found!');
    }
    
    katex.render("i^2 = -1", document.getElementById("imaginary-unit"));
    katex.render("z = a + bi", document.getElementById("complex-form"));
    katex.render("z = 3 + 2i", document.getElementById("example-complex"));
    katex.render("(a + bi) + (c + di) = (a + c) + (b + d)i", document.getElementById("addition-rule"));
    katex.render("(2 + 3i) + (4 - i) = (2 + 4) + (3 - 1)i = 6 + 2i", document.getElementById("addition-example-detailed"));
    katex.render("(2 + 3i) + (4 - i)", document.getElementById("addition-exercise"));
    
    // ××™×§×¨×•-×©×™×¢×•×¨ 5: ×›×¤×œ
    katex.render("(a + bi)(c + di) = (ac - bd) + (ad + bc)i", document.getElementById("multiplication-rule"));
    katex.render("i^2 = -1", document.getElementById("i-squared-rule"));
    katex.render("(1 + 2i)(3 + i)", document.getElementById("multiplication-exercise"));
    katex.render("(1 + 2i)(3 + i) = 1 \\cdot 3 + 1 \\cdot i + 2i \\cdot 3 + 2i \\cdot i", document.getElementById("multiplication-example-step1"));
    katex.render("= 3 + i + 6i + 2i^2", document.getElementById("multiplication-example-step2"));
    katex.render("= 3 + 7i + 2(-1) = 3 + 7i - 2 = 1 + 7i", document.getElementById("multiplication-example-step3"));
    
    // ××™×§×¨×•-×©×™×¢×•×¨ 6: ×ª×¨×’×™×œ×™× ××ª×§×“××™×
    katex.render("(2 + i)(1 - 2i)", document.getElementById("advanced-exercise1"));
    katex.render("z + (3 - i) = 4 + i", document.getElementById("advanced-exercise2"));
    
    katex.render("a + bi", document.getElementById("summary-form"));
    katex.render("i^2 = -1", document.getElementById("summary-i"));
    
    console.log('âœ… Math rendering completed successfully!');
  } catch (e) {
    console.error("âŒ KaTeX rendering error:", e);
  }
}

// Making functions globally available for HTML access - MOVED TO TOP
window.nextMicro = function() {
  console.log('ğŸ”„ nextMicro called, currentMicro:', currentMicro, 'totalMicros:', totalMicros);
  if (currentMicro < totalMicros) {
    document.querySelector(`[data-micro="${currentMicro}"]`).classList.remove('active');
    currentMicro++;
    document.querySelector(`[data-micro="${currentMicro}"]`).classList.add('active');
    updateProgress();
    addPoints(15);
    
    console.log('âœ… Moved to micro:', currentMicro);
    
    // ×’×œ×™×œ×” ×—×œ×§×” ×œ××¢×œ×”
    document.querySelector('.micro-lesson-integrated.active').scrollIntoView({ 
      behavior: 'smooth', 
      block: 'start' 
    });
  } else {
    console.log('âš ï¸ Already at last micro');
  }
};

window.prevMicro = function() {
  console.log('ğŸ”„ prevMicro called, currentMicro:', currentMicro);
  if (currentMicro > 1) {
    document.querySelector(`[data-micro="${currentMicro}"]`).classList.remove('active');
    currentMicro--;
    document.querySelector(`[data-micro="${currentMicro}"]`).classList.add('active');
    updateProgress();
    
    console.log('âœ… Moved back to micro:', currentMicro);
    
    // ×’×œ×™×œ×” ×—×œ×§×” ×œ××¢×œ×”
    document.querySelector('.micro-lesson-integrated.active').scrollIntoView({ 
      behavior: 'smooth', 
      block: 'start' 
    });
  } else {
    console.log('âš ï¸ Already at first micro');
  }
};

window.selectAnswer = function(button, isCorrect) {
  const feedbackId = `feedback-${currentMicro}`;
  const feedback = document.getElementById(feedbackId);
  const allButtons = button.parentElement.querySelectorAll('.answer-button-integrated');
  
  // ××™×¤×•×¡ ×‘×—×™×¨×•×ª ×§×•×“××•×ª
  allButtons.forEach(btn => {
    btn.classList.remove('selected', 'correct');
  });
  
  // ×¡×™××•×Ÿ ×”×ª×©×•×‘×”
  button.classList.add('selected');
  
  if (isCorrect) {
    button.classList.add('correct');
    feedback.className = 'feedback-integrated success';
    feedback.textContent = 'âœ… × ×›×•×Ÿ ×××•×“! ××¢×•×œ×”!';
    feedback.style.display = 'block';
    addPoints(10);
  } else {
    feedback.className = 'feedback-integrated error';
    feedback.textContent = 'âŒ ×œ× × ×›×•×Ÿ. ×—×©×‘×• ×©×•×‘ ×•× ×¡×•!';
    feedback.style.display = 'block';
  }
};

window.testButton = function() {
  console.log('ğŸ”´ Test button clicked!');
  alert('Button is working!');
};

console.log('ğŸŒ Global functions registered at top:', {
  nextMicro: typeof window.nextMicro,
  prevMicro: typeof window.prevMicro,
  selectAnswer: typeof window.selectAnswer,
  testButton: typeof window.testButton
});

// ××¢×‘×¨ ×œ××™×§×¨×• ×”×‘× - Ğ£Ğ”ĞĞ›Ğ•ĞĞ Ğ”Ğ£Ğ‘Ğ›Ğ˜ĞšĞĞ¦Ğ˜Ğ¯

// ××¢×‘×¨ ×œ××™×§×¨×• ×”×§×•×“×
function prevMicro() {
  console.log('ğŸ”„ prevMicro called, currentMicro:', currentMicro);
  if (currentMicro > 1) {
    document.querySelector(`[data-micro="${currentMicro}"]`).classList.remove('active');
    currentMicro--;
    document.querySelector(`[data-micro="${currentMicro}"]`).classList.add('active');
    updateProgress();
    
    console.log('âœ… Moved back to micro:', currentMicro);
    
    // ×’×œ×™×œ×” ×—×œ×§×” ×œ××¢×œ×”
    document.querySelector('.micro-lesson-integrated.active').scrollIntoView({ 
      behavior: 'smooth', 
      block: 'start' 
    });
  } else {
    console.log('âš ï¸ Already at first micro');
  }
}

// ×¢×“×›×•×Ÿ ×”×ª×§×“××•×ª
function updateProgress() {
  const progress = (currentMicro / totalMicros) * 100;
  document.getElementById('main-progress').style.width = progress + '%';
  document.getElementById('progress-text').textContent = Math.round(progress) + '% ×”×•×©×œ×';
}

// ×”×•×¡×¤×ª × ×§×•×“×•×ª
function addPoints(points) {
  totalPoints += points;
  document.getElementById('points-display').textContent = `+${totalPoints} × ×§×•×“×•×ª`;
}

// ×‘×—×™×¨×ª ×ª×©×•×‘×”
function selectAnswer(button, isCorrect) {
  const feedbackId = `feedback-${currentMicro}`;
  const feedback = document.getElementById(feedbackId);
  const allButtons = button.parentElement.querySelectorAll('.answer-button-integrated');
  
  // ××™×¤×•×¡ ×‘×—×™×¨×•×ª ×§×•×“××•×ª
  allButtons.forEach(btn => {
    btn.classList.remove('selected', 'correct');
  });
  
  // ×¡×™××•×Ÿ ×”×ª×©×•×‘×”
  button.classList.add('selected');
  
  if (isCorrect) {
    button.classList.add('correct');
    feedback.className = 'feedback-integrated success';
    feedback.textContent = 'âœ… × ×›×•×Ÿ ×××•×“! ××¢×•×œ×”!';
    feedback.style.display = 'block';
    addPoints(10);
  } else {
    feedback.className = 'feedback-integrated error';
    feedback.textContent = 'âŒ ×œ× × ×›×•×Ÿ. ×—×©×‘×• ×©×•×‘ ×•× ×¡×•!';
    feedback.style.display = 'block';
  }
}

// ×¤×•× ×§×¦×™×•×ª × ×¤×¨×“×•×ª ×œ××™×§×¨×•-×©×™×¢×•×¨ 6
function selectAnswer6a(button, isCorrect) {
  const feedback = document.getElementById('feedback-6a');
  const allButtons = button.parentElement.querySelectorAll('.answer-button-integrated');
  
  // ××™×¤×•×¡ ×‘×—×™×¨×•×ª ×§×•×“××•×ª
  allButtons.forEach(btn => {
    btn.classList.remove('selected', 'correct');
  });
  
  // ×¡×™××•×Ÿ ×”×ª×©×•×‘×”
  button.classList.add('selected');
  
  if (isCorrect) {
    button.classList.add('correct');
    feedback.className = 'feedback-integrated success';
    feedback.textContent = 'âœ… × ×›×•×Ÿ! ×”×—×œ×§ ×”×××©×™ ×”×•× 4';
    feedback.style.display = 'block';
    addPoints(10);
  } else {
    feedback.className = 'feedback-integrated error';
    feedback.textContent = 'âŒ ×œ× × ×›×•×Ÿ. ×–×›×¨×•: (2 + i)(1 - 2i) = 2 - 4i + i - 2iÂ² = 2 - 3i + 2 = 4 - 3i';
    feedback.style.display = 'block';
  }
}

function selectAnswer6b(button, isCorrect) {
  const feedback = document.getElementById('feedback-6b');
  const allButtons = button.parentElement.querySelectorAll('.answer-button-integrated');
  
  // ××™×¤×•×¡ ×‘×—×™×¨×•×ª ×§×•×“××•×ª
  allButtons.forEach(btn => {
    btn.classList.remove('selected', 'correct');
  });
  
  // ×¡×™××•×Ÿ ×”×ª×©×•×‘×”
  button.classList.add('selected');
  
  if (isCorrect) {
    button.classList.add('correct');
    feedback.className = 'feedback-integrated success';
    feedback.textContent = 'âœ… × ×›×•×Ÿ! z = 1 + 2i ×”×•× ×”×¤×ª×¨×•×Ÿ';
    feedback.style.display = 'block';
    addPoints(10);
  } else {
    feedback.className = 'feedback-integrated error';
    feedback.textContent = 'âŒ ×œ× × ×›×•×Ÿ. × ×¡×• ×œ×¤×ª×•×¨: z + (3 - i) = 4 + i â† z = (4 + i) - (3 - i) = 1 + 2i';
    feedback.style.display = 'block';
  }
}

// ×¡×™×•× ×”×©×™×¢×•×¨×™×
function completeLessons() {
  alert('ğŸ‰ ×›×œ ×”×›×‘×•×“! ×¡×™×™××ª× ×‘×”×¦×œ×—×” ××ª ×”×©×™×¢×•×¨ ×”××œ× ×¢×œ ×¦×•×¨×” ××œ×’×‘×¨×™×ª ×©×œ ××¡×¤×¨×™× ××¨×•×›×‘×™×!\n\n×”×¨×•×•×—×ª× 100+ × ×§×•×“×•×ª ×•×”×’×¢×ª× ×œ×“×¨×’×ª ××•××—×”!');
  
  // ×—×–×¨×” ×œ×¢××•×“ ×”× ×•×©××™×
  if (window.pageLoader) {
    window.pageLoader.loadPage('courses/5-units/35572/35572-index');
  }
}

// ××ª×—×•×œ
function initializeLessonWhenReady() {
  console.log('ğŸ”„ Initializing modern lesson...');
  
  // ×‘×“×™×§×” ×× DOM ××•×›×Ÿ
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initializeLessonWhenReady);
    return;
  }
  
  // ×¤×•× ×§×¦×™×” ×œ×‘×“×™×§×” ×× KaTeX ×–××™×Ÿ
  function waitForKaTeX() {
    if (typeof katex !== 'undefined') {
      console.log('âœ… KaTeX loaded, initializing math rendering...');
      renderMath();
      updateProgress();
      
      // ×”×¤×¢×œ×ª ×˜×™×™××¨ ×œ×©×™×¢×•×¨ ×”×¨××©×•×Ÿ
      startTimer(1, 3 * 60);
    } else {
      console.log('â³ Waiting for KaTeX...');
      setTimeout(waitForKaTeX, 100);
    }
  }
  
  // ×”×ª×—×œ×ª ×”×ª×”×œ×™×š
  waitForKaTeX();
}

// ×§×¨×™××” ××™×™×“×™×ª ××• ×”××ª× ×” ×œ-DOM
initializeLessonWhenReady();

// ×¤×•× ×§×¦×™×™×ª ×˜×™×™××¨
function startTimer(microNum, seconds) {
  const timerElement = document.getElementById(`timer-${microNum}`);
  if (!timerElement) return;
  
  const interval = setInterval(() => {
    const minutes = Math.floor(seconds / 60);
    const secs = seconds % 60;
    timerElement.textContent = `${minutes}:${secs.toString().padStart(2, '0')}`;
    
    if (seconds <= 0) {
      clearInterval(interval);
      timerElement.textContent = 'â° ×–××Ÿ!';
      timerElement.style.background = '#dc2626';
      timerElement.style.color = 'white';
    }
    seconds--;
  }, 1000);
}

// Test button click handler for duplicates
window.selectAnswer6a = selectAnswer6a;
window.selectAnswer6b = selectAnswer6b;
window.completeLessons = completeLessons;

console.log('ğŸŒ Additional functions registered:', {
  selectAnswer6a: typeof window.selectAnswer6a,
  selectAnswer6b: typeof window.selectAnswer6b,
  completeLessons: typeof window.completeLessons
});
</script>
